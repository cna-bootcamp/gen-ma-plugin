전문적인 시퀀스 다이어그램(Sequence Diagram)을 생성하세요.
주제: "DMAP 위임형 스킬의 에이전트 구동 흐름"

중요 규칙: 모든 텍스트는 한글로 작성. 고유명사만 영문 허용 (AGENT.md, agentcard.yaml, tools.yaml, runtime-mapping.yaml, Task, claude-opus-4-6, Read, Grep, Write, Edit, lsp_diagnostics, HIGH, FQN 등).

레이아웃: 왼쪽에서 오른쪽으로 5개 참여자가 세로 생명선(lifeline)을 가지고, 위에서 아래로 시간순 메시지가 흐르는 UML 시퀀스 다이어그램.
스타일: 모던하고 깔끔한 기술 다이어그램. 흰색 배경. 각 단계를 색상 배경 영역(rect)으로 구분.

상단 제목: "DMAP: 위임형 스킬의 에이전트 구동 흐름"

5명의 참여자 (왼쪽→오른쪽):
1. 사용자 (사람 아이콘)
2. 위임형 스킬 (Controller) (파란색 박스)
3. 에이전트 패키지 (agents/{name}/) (초록색 박스)
4. Gateway (runtime-mapping.yaml) (주황색 박스)
5. 에이전트 (Service) (보라색 박스)

시퀀스 흐름 (위→아래 시간순):

[사용자 → 위임형 스킬]: "작업 요청" (실선 화살표)

【단계 ① 에이전트 패키지 로드】 (연한 파란색 배경 영역)
[위임형 스킬 → 에이전트 패키지]: "3파일 읽기"
[에이전트 패키지 → 위임형 스킬]: "AGENT.md + agentcard.yaml + tools.yaml 반환" (점선 화살표, 응답)

【단계 ② runtime-mapping.yaml 참조하여 구체화】 (연한 주황색 배경 영역)
세 번의 요청-응답 쌍:
[위임형 스킬 → Gateway]: "tier 전달 (예: HIGH)"
[Gateway → 위임형 스킬]: "모델 구체화 (예: claude-opus-4-6)" (점선 응답)
[위임형 스킬 → Gateway]: "tools.yaml 추상 도구 전달"
[Gateway → 위임형 스킬]: "도구 구체화 (예: Read, Grep, lsp_diagnostics)" (점선 응답)
[위임형 스킬 → Gateway]: "forbidden_actions 전달 (예: file_write)"
[Gateway → 위임형 스킬]: "금지 액션 구체화 (예: Write, Edit)" (점선 응답)

【단계 ③ 최종 도구 계산】 (연한 초록색 배경 영역)
위임형 스킬 내부 노트: "최종 도구 = 구체화 도구 - 제외 도구"

【단계 ④ 프롬프트 조립】 (연한 초록색 배경 영역, 단계③과 같은 영역)
위임형 스킬 내부 노트: "프롬프트 조립 (3파일 합치기)"
[위임형 스킬 → 에이전트]: "Task(FQN, model=opus, prompt=조립된 프롬프트)" (실선 화살표)

【단계 ⑤ 자율 실행】 (연한 보라색 배경 영역)
에이전트 내부 노트: "자율 실행 (최종 도구만 사용)"
[에이전트 → 위임형 스킬]: "실행 결과" (점선 응답)
[위임형 스킬 → 사용자]: "결과 보고" (점선 응답)

하단에 Gateway 세분류 표:
| 유형 | 도구 예시 |
| File | Read, Write, Edit, Glob, Grep |
| Shell | Bash |
| Web | WebSearch, WebFetch |
| MCP | context7, exa, playwright |
| LSP | diagnostics, hover, references |
| Custom | AST grep, Python REPL |

하단 텍스트: "DMAP 선언형 멀티에이전트 플러그인 표준 | 위임형 스킬: 라우팅+오케스트레이션만 수행, 작업 실행은 에이전트에 위임"
